description: |-
  Alignment metadata defines how the physical sample or section is oriented relative to a reference 3D organ model. In general, this data is generated by the Registration User Interface (RUI). We assume that the reference objects are scaled to 1 unit = 1 millimeter. A reference object file with a maximum dimension of 100 is assumed to mean the maximum size is 100mm.
type: object
required:
  - id
properties:
  id:
    description: UUID for each registration
    type: string
    format: uuid
    example: d290f1ee-6c54-4b01-90e6-d701748f0851
  alignment_operator_orcid:
    description: ORCID of the person that did the alignment
    type: string
    example: 'https://orcid.org/0000-0002-1825-0097'
  alignment_date_time:
    description: Date and time the alignment was done
    type: string
    format: date-time
    example: '2009-06-15T13:45:30'
  reference_organ_id:
    description: ID of the reference organ the sample was placed in
    type: string
    format: uuid
    example: d290f1ee-6c54-4b01-90e6-d701748f0851
  organ_object_size:
    description: |-
      Dimensions (in millimeters) of entire organ, if available.
    allOf: # Should be anyOf, but openapi-to-graphql can't support that yet
      - description: Dimensions when orientation is unknown
        type: object
        properties:
          L:
            description: Length (lateral-medial axis)
            type: number
            format: float
          W:
            description: Width (anterior-posterior axis)
            type: number
            format: float
          H:
            description: Height (superior (head)-inferior (foot) axis)
            type: number
            format: float
        example: {'L': 19, 'W': 13, 'H': 7}
      - description: Dimensions when orientation is known
        type: object
        properties:
          LM:
            description: Length (lateral-medial axis)
            type: number
            format: float
          AP:
            description: Width (anterior-posterior axis)
            type: number
            format: float
          SI:
            description: Height (superior (head)-inferior (foot) axis)
            type: number
            format: float
        example: {'LM': 19, 'AP': 13, 'SI': 7}
  sample_position_center:
    description: |
      Sample’s center of volume position in the same coordinates as the reference object.
      Float, x,y,z list of coordinates.
    allOf:
      - $ref: './point.yaml'
  sample_object_rotation:
    description: |-
      Rotations of the sample object. Rotations must be done in the order given:
      x-rotation, y-rotation, z-rotation. Floating point numbers must be in degrees.
    allOf:
      - $ref: './point.yaml'
  sample_object_dimensions:
    description: |-
      Dimensions of final sample. In the same units as the reference object. 
      Float, x,y,z list of distances. These are the dimensions of the square 
      prism selection region and not coordinates of the alignment. 
      Units are in millimeters.
    allOf:
      - $ref: './point.yaml'
  bounding_box_vertex_coordinates:
    description: |-
      List of (x,y,z) coordinates for the vertices of the selection box. These 
      are after any rotations or translations and are generated directly from 
      the alignment UI. In the same units as the reference object and therefore 
      are in mm. Note: This data is preferred to giving the box’s dimensions, 
      offsets and rotations.
      Float, x,y,z list of list of vertex locations. For a rectangular prism
      there are 8 vertex locations. Note that if the image is pixel based the
      vertex positions do not necessarily fall on image lattice points.
    type: array
    items:
      $ref: './point.yaml'
  bounding_shape:
    description: |-
      Shape of the selection box. Either a rectangular region (rectangular prism)
      or a cylindrical region for a needle biopsy.
    type: string
    enum:
      - rectangular
      - cylindrical
    example: rectangular
  alignment_screenshot:
    description: |-
      Screenshot of the alignment interface showing both the reference organ and
      the final positioning of the selection region. This is needed for
      downstream validation. Should be a URL to an 
      image suitable for display in a web browser (PNG, JPEG, GIF, etc).
    type: string
    format: url
    example: https://i.kym-cdn.com/entries/icons/original/000/005/608/nyan-cat-01-625x450.jpg
  base_section_plane:
    description: |-
      The coordinates of the face of the selection region (typically a rectangular
      region) that is the first section that will be taken. Subsequent sections
      will move from this face. For example, the rectangle highlighted in red in
      the image below. Float, x,y,z list of vertex locations. For a rectangular
      region there are 4 vertices.
    type: array
    items:
      $ref: './point.yaml'
  reference_vertices:
    description: |-
      The coordinates of the three corners of the selection region used as a 
      “dog ear” corner. This corner is used for subsequent alignment of the 
      sample when it is analyzed or further sectioned. Float, x,y,z list of vertex
      locations. There are 3 vertices.
    type: array
    items:
      $ref: './point.yaml'
  notes:
    description: |
      Free text comments. This field can contain information that doesn’t 
      fit in other fields, comments, notes, exceptions etc.
    type: string
    example: This donor was part of the XX-YYY study.
